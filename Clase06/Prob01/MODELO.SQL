
CREATE TABLE DEPARTAMENTO
( 
	IDDEPARTAMENTO       integer  NOT NULL ,
	NOMBRE               varchar(150)  NOT NULL ,
	CONSTRAINT XPKDEPARTAMENTO PRIMARY KEY (IDDEPARTAMENTO ASC)
)
go



CREATE TABLE PROFESION
( 
	IDPROFESION          integer  NOT NULL ,
	NOMBRE               varchar(150)  NOT NULL ,
	CONSTRAINT XPKPROFESION PRIMARY KEY (IDPROFESION ASC)
)
go



CREATE TABLE EMPLEADO
( 
	IDEMPLEADO           integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(100)  NOT NULL ,
	APELLIDO             varchar(100)  NOT NULL ,
	IDDEPARTAMENTO       integer  NULL ,
	IDPROFESION          integer  NULL ,
	CONSTRAINT XPKEMPLEADO PRIMARY KEY (IDEMPLEADO ASC),
	CONSTRAINT R_1 FOREIGN KEY (IDDEPARTAMENTO) REFERENCES DEPARTAMENTO(IDDEPARTAMENTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT R_2 FOREIGN KEY (IDPROFESION) REFERENCES PROFESION(IDPROFESION)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE REQUERIMIENTO
( 
	IDREQUERIMIENTO      integer IDENTITY ( 1,1 ) ,
	IDDEPARTAMENTO       integer  NULL ,
	IDEMPLEADO           integer  NULL ,
	FECHA                datetime  NULL ,
	CONSTRAINT XPKREQUERIMIENTO PRIMARY KEY (IDREQUERIMIENTO ASC),
	CONSTRAINT R_3 FOREIGN KEY (IDEMPLEADO) REFERENCES EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT R_6 FOREIGN KEY (IDDEPARTAMENTO) REFERENCES DEPARTAMENTO(IDDEPARTAMENTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE TIPO
( 
	IDTIPO               numeric(5)  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKTIPO PRIMARY KEY (IDTIPO ASC)
)
go



CREATE TABLE SERVICIO
( 
	IDSERVICIO           integer  NOT NULL ,
	NOMBRE               varchar(150)  NOT NULL ,
	IDTIPO               numeric(5)  NOT NULL ,
	PRECIO               numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKSERVICIO PRIMARY KEY (IDSERVICIO ASC),
	CONSTRAINT FK_SERVICIO_TIPO FOREIGN KEY (IDTIPO) REFERENCES TIPO(IDTIPO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE DETALLE
( 
	IDREQUERIMIENTO      integer  NOT NULL ,
	IDSERVICIO           integer  NOT NULL ,
	CANTIDAD             numeric(8)  NOT NULL ,
	PRECIO               numeric(12,2)  NOT NULL ,
	IMPORTE              numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKDETALLE PRIMARY KEY (IDREQUERIMIENTO ASC,IDSERVICIO ASC),
	CONSTRAINT R_4 FOREIGN KEY (IDREQUERIMIENTO) REFERENCES REQUERIMIENTO(IDREQUERIMIENTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT R_5 FOREIGN KEY (IDSERVICIO) REFERENCES SERVICIO(IDSERVICIO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE ATENCION
( 
	IDREQUERIMIENTO      integer  NOT NULL ,
	IDSERVICIO           integer  NOT NULL ,
	IDEMPLEADO           integer  NOT NULL ,
	FECASIGNACION        datetime  NOT NULL ,
	FECINICIO            datetime  NULL ,
	FECFINALIZACION      datetime  NULL ,
	CONSTRAINT XPKATENCION PRIMARY KEY (IDREQUERIMIENTO ASC,IDSERVICIO ASC,IDEMPLEADO ASC),
	CONSTRAINT R_8 FOREIGN KEY (IDEMPLEADO) REFERENCES EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT R_9 FOREIGN KEY (IDREQUERIMIENTO,IDSERVICIO) REFERENCES DETALLE(IDREQUERIMIENTO,IDSERVICIO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go


