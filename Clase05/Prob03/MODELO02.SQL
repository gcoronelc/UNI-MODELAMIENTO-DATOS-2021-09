
DROP TABLE dbo.VENTA
go



DROP TABLE dbo.CLIENTE
go



DROP TABLE dbo.REVISION_SERVICIO
go



DROP TABLE dbo.SERVICIO
go



DROP TABLE dbo.REVISION
go



DROP TABLE dbo.AUTO
go



DROP TABLE dbo.MARCA
go



CREATE TABLE dbo.MARCA
( 
	IDMARCA              integer  NOT NULL ,
	NOMBRE               varchar(20)  NULL ,
	CONSTRAINT XPKMARCA PRIMARY KEY (IDMARCA ASC)
)
go



CREATE TABLE dbo.AUTO
( 
	IDAUTO               integer  NOT NULL ,
	IDMARCA              integer  NOT NULL ,
	NROSERIE             varchar(20)  NULL ,
	MODELO               varchar(50)  NOT NULL ,
	PRECIO               numeric(12,2)  NOT NULL 
	CONSTRAINT CK_AUTO_PRECIO
		CHECK  ( PRECIO > 0 ),
	VENDIDO              numeric(2)  NOT NULL 
	CONSTRAINT CK_AUTO_VENDIDO
		CHECK  ( VENDIDO IN (0,1) ),
	CONSTRAINT XPKAUTO PRIMARY KEY (IDAUTO ASC),
	CONSTRAINT FK_AUTO_MARCA FOREIGN KEY (IDMARCA) REFERENCES dbo.MARCA(IDMARCA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.REVISION
( 
	IDREVISION           integer  NOT NULL ,
	IDAUTO               integer  NOT NULL ,
	SUBTOTAL             numeric(12,2)  NOT NULL ,
	IMPUESTO             numeric(12,2)  NOT NULL ,
	TOTAL                numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKREVISION PRIMARY KEY (IDREVISION ASC),
	CONSTRAINT FK_REVISION_AUTO FOREIGN KEY (IDAUTO) REFERENCES dbo.AUTO(IDAUTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.SERVICIO
( 
	IDSERVICIO           integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	PRECIO               numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKSERVICIO PRIMARY KEY (IDSERVICIO ASC)
)
go



CREATE TABLE dbo.REVISION_SERVICIO
( 
	IDREVISION           integer  NOT NULL ,
	IDSERVICIO           integer  NOT NULL ,
	PRECIO               numeric(12,2)  NOT NULL ,
	CANTIDAD             integer  NOT NULL ,
	SUBTOTAL             numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKREVISION_SERVICIO PRIMARY KEY (IDREVISION ASC,IDSERVICIO ASC),
	CONSTRAINT FK_REVISION_SERVICIO_REVISION FOREIGN KEY (IDREVISION) REFERENCES dbo.REVISION(IDREVISION)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_REVISION_SERVICIO_SERVICIO FOREIGN KEY (IDSERVICIO) REFERENCES dbo.SERVICIO(IDSERVICIO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.CLIENTE
( 
	IDCLIENTE            integer  NOT NULL ,
	NOMBRE               varchar(150)  NULL ,
	CONSTRAINT XPKCLIENTE PRIMARY KEY (IDCLIENTE ASC)
)
go



CREATE TABLE dbo.VENTA
( 
	IDVENTA              integer  NOT NULL ,
	IDAUTO               integer  NOT NULL ,
	IDCLIENTE            integer  NOT NULL ,
	SUBTOTAL             numeric(12,2)  NOT NULL ,
	IMPUESTO             numeric(12,2)  NOT NULL ,
	TOTAL                numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKVENTA PRIMARY KEY (IDVENTA ASC),
	CONSTRAINT FK_VENTA_AUTO FOREIGN KEY (IDAUTO) REFERENCES dbo.AUTO(IDAUTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VENTA_CLIENTE FOREIGN KEY (IDCLIENTE) REFERENCES dbo.CLIENTE(IDCLIENTE)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go


